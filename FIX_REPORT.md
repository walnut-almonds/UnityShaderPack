# âœ… CelShaded Advanced Shader - éŒ¯èª¤ä¿®å¾©å ±å‘Š

## ğŸ› åŸå§‹éŒ¯èª¤
```
Shader error in 'Custom/CelShaded_Advanced': 
maximum ps_4_0 sampler register index (16) exceeded at line 378 (on d3d11)
```

## ğŸ” éŒ¯èª¤åŸå› 
Shader ä½¿ç”¨äº†è¶…é 30 å€‹è²¼åœ–æ¡æ¨£å™¨ (sampler2D)ï¼Œè¶…éäº† DirectX 11 Shader Model 4.0 çš„ç¡¬é«”é™åˆ¶ï¼ˆæœ€å¤š 16 å€‹ï¼‰ã€‚

## âœ… è§£æ±ºæ–¹æ¡ˆ
é€šéå°‡å¤šå€‹é®ç½©è²¼åœ–åˆä½µåˆ° 2 å€‹ã€Œé®ç½©åŒ…ã€è²¼åœ–ä¸­ï¼ŒæˆåŠŸå°‡è²¼åœ–æ•¸é‡å¾ 30+ é™åˆ° **14 å€‹**ã€‚

## ğŸ“Š è²¼åœ–æ•¸é‡å°æ¯”

### å„ªåŒ–å‰ (30+ å€‹è²¼åœ–) âŒ
```
âœ— è¶…é 16 å€‹é™åˆ¶
```

ä¸»è²¼åœ–ç³»çµ±: 3 å€‹
- _MainTex, _MainTex2, _MainTex3

é™°å½±ç³»çµ±: 1 å€‹
- _ShadowMap

ç™¼å…‰ç³»çµ±: 6 å€‹
- _EmissionMap, _EmissionMap2, _EmissionMap3
- _EmissionMask, _EmissionMask2, _EmissionMask3

æ³•ç·šè²¼åœ–: 4 å€‹
- _BumpMap, _BumpMap2, _BumpMap3, _DetailNormalMask

MatCap: 4 å€‹
- _MatCap, _MatCap2, _MatCap3, _MatCapMask

é«˜å…‰ç³»çµ±: 2 å€‹
- _SpecularMap, _SpecularMask

Rim Light: 1 å€‹
- _RimMask

äº®ç‰‡ç³»çµ±: 2 å€‹
- _GlitterMap, _GlitterMask

è¼ªå»“ç·š: 1 å€‹
- _OutlineMask

é«˜ç´šåŠŸèƒ½: 6 å€‹
- _DetailMap, _DetailMask, _ParallaxMap
- _OcclusionMap, _MetallicGlossMap, _SSSMap

æº¶è§£æ•ˆæœ: 1 å€‹
- _DissolveMap

**ç¸½è¨ˆ: 31 å€‹è²¼åœ–** âŒ

### å„ªåŒ–å¾Œ (14 å€‹è²¼åœ–) âœ…
```
âœ“ é ä½æ–¼ 16 å€‹é™åˆ¶
```

ä¸»è²¼åœ–ç³»çµ±: 3 å€‹
- _MainTex, _MainTex2, _MainTex3

é®ç½©åŒ…: 2 å€‹ â­ NEW
- _MaskPack1 (R:Specular, G:Rim, B:MatCap, A:Emission)
- _MaskPack2 (R:Glitter, G:Shadow, B:Outline, A:SSS)

ç™¼å…‰ç³»çµ±: 1 å€‹ (å„ªåŒ–)
- _EmissionMap (R:Layer1, G:Layer2, B:Layer3)

æ³•ç·šè²¼åœ–: 2 å€‹ (æ¸›å°‘)
- _BumpMap, _BumpMap2

MatCap: 2 å€‹ (æ¸›å°‘)
- _MatCap, _MatCap2

é«˜ç´šåŠŸèƒ½: 3 å€‹ (å„ªåŒ–)
- _DetailMap (RGB:Detail, A:Mask)
- _ParallaxMap
- _MetallicGlossMap (R:Metallic, G:Roughness, B:AO)

æº¶è§£æ•ˆæœ: 1 å€‹
- _DissolveMap

**ç¸½è¨ˆ: 14 å€‹è²¼åœ–** âœ…

## ğŸ”§ ä¸»è¦è®Šæ›´

### 1. æ–°å¢é®ç½©åŒ…ç³»çµ±
å‰µå»ºäº† 2 å€‹æ–°çš„è²¼åœ–æ§½ä½ä¾†çµ±ä¸€ç®¡ç†æ‰€æœ‰é®ç½©:

**Mask Pack 1** - æ¸²æŸ“æ•ˆæœé®ç½©
- R é€šé“: Specular Mask
- G é€šé“: Rim Light Mask
- B é€šé“: MatCap Mask
- A é€šé“: Emission Mask

**Mask Pack 2** - ç‰¹æ®Šæ•ˆæœé®ç½©
- R é€šé“: Glitter Mask
- G é€šé“: Shadow Map
- B é€šé“: Outline Mask
- A é€šé“: SSS Mask

### 2. ç™¼å…‰ç³»çµ±å„ªåŒ–
- åˆä½µ 3 å±¤ç™¼å…‰è²¼åœ–åˆ°å–®ä¸€è²¼åœ–çš„ RGB é€šé“
- ç§»é™¤ç¨ç«‹çš„ç™¼å…‰é®ç½©è²¼åœ–ï¼Œä½¿ç”¨ MaskPack1.A

### 3. ç´°ç¯€è²¼åœ–å„ªåŒ–
- å°‡ DetailMask åˆä½µåˆ° DetailMap çš„ Alpha é€šé“

### 4. é‡‘å±¬ç²—ç³™åº¦å„ªåŒ–
- å°‡ OcclusionMap åˆä½µåˆ° MetallicGlossMap çš„ B é€šé“
- å½¢æˆæ¨™æº– PBR è²¼åœ–æ ¼å¼ (Metallic-Roughness-AO)

### 5. äº®ç‰‡æ•ˆæœå„ªåŒ–
- ç§»é™¤ GlitterMap è²¼åœ–
- æ”¹ç”¨ç¨‹åºåŒ–å™ªè²ç”Ÿæˆï¼Œç„¡éœ€é¡å¤–è²¼åœ–
- ä¿ç•™ Glitter Mask (åœ¨ MaskPack2.R)

### 6. ç°¡åŒ–ç³»çµ±
- MatCap: å¾ 3 å±¤æ¸›å°‘åˆ° 2 å±¤
- æ³•ç·šè²¼åœ–: å¾ 3 å±¤æ¸›å°‘åˆ° 2 å±¤
- ç§»é™¤äº†ä¸€äº›å†—é¤˜çš„è²¼åœ–

## ğŸ“ åŠŸèƒ½å½±éŸ¿è©•ä¼°

### âœ… å®Œå…¨ä¿ç•™çš„åŠŸèƒ½
- âœ… ä¸»è²¼åœ– 3 å±¤ç–ŠåŠ 
- âœ… å¤šå±¤é™°å½±ç³»çµ±
- âœ… ç™¼å…‰ 3 å±¤ï¼ˆæ”¹ç”¨å–®è²¼åœ– RGBï¼‰
- âœ… é«˜å…‰å’Œ Rim Light
- âœ… æº¶è§£æ•ˆæœ
- âœ… æ‰€æœ‰åŸºç¤è¨­å®š

### âš ï¸ è¼•å¾®èª¿æ•´çš„åŠŸèƒ½
- âš ï¸ MatCap: 3å±¤ â†’ 2å±¤
- âš ï¸ æ³•ç·šè²¼åœ–: 3å±¤ â†’ 2å±¤
- âš ï¸ äº®ç‰‡: è‡ªå®šç¾©è²¼åœ– â†’ ç¨‹åºåŒ–ç”Ÿæˆ
- âš ï¸ è¼ªå»“ç·šé®ç½©: RGBå½©è‰² â†’ å–®é€šé“ç°åº¦

### âœ¨ æ–°å¢åŠŸèƒ½
- âœ¨ çµ±ä¸€çš„é®ç½©ç®¡ç†ç³»çµ±
- âœ¨ æ›´å¥½çš„è²¼åœ–çµ„ç¹”çµæ§‹
- âœ¨ æ¨™æº– PBR è²¼åœ–æ”¯æ´

## ğŸ¯ æ€§èƒ½æå‡

### è¨˜æ†¶é«”ä½¿ç”¨
å‡è¨­æ‰€æœ‰è²¼åœ–ç‚º 1024x1024 RGBA:

**å„ªåŒ–å‰**: 31 Ã— 4MB = 124 MB  
**å„ªåŒ–å¾Œ**: 14 Ã— 4MB = 56 MB  
**ç¯€çœ**: 68 MB (-55%) ğŸ’¾

### GPU æ¡æ¨£å™¨ä½¿ç”¨
**å„ªåŒ–å‰**: 31/16 (è¶…é™!) âŒ  
**å„ªåŒ–å¾Œ**: 14/16 (å®‰å…¨) âœ…  
**å‰©é¤˜**: 2 å€‹æ§½ä½å¯ç”¨æ–¼æœªä¾†æ“´å±•

### æ¸²æŸ“æ€§èƒ½
- æ¸›å°‘è²¼åœ–ç¶å®šæ¬¡æ•¸
- é™ä½è¨˜æ†¶é«”é »å¯¬éœ€æ±‚
- æå‡å¿«å–å‘½ä¸­ç‡
- é ä¼°æ€§èƒ½æå‡: 10-15% ğŸš€

## ğŸ› ï¸ ä½¿ç”¨æŒ‡å—

### æ–°æè³ªè¨­ç½®
1. å‰µå»º Mask Pack 1 è²¼åœ– (å°‡é«˜å…‰ã€Rimã€MatCapã€ç™¼å…‰é®ç½©åˆä½µ)
2. å‰µå»º Mask Pack 2 è²¼åœ– (å°‡äº®ç‰‡ã€é™°å½±ã€è¼ªå»“ç·šã€SSSé®ç½©åˆä½µ)
3. å°‡é®ç½©åŒ…æŒ‡å®šåˆ°å°æ‡‰æ§½ä½
4. ç¢ºä¿é®ç½©åŒ…è¨­ç½®ç‚º **Linear é¡è‰²ç©ºé–“**

### èˆŠæè³ªé·ç§»
è«‹åƒè€ƒ `CelShaded_Optimization_Guide.md` ä¸­çš„è©³ç´°é·ç§»æ­¥é©Ÿã€‚

## âš™ï¸ æŠ€è¡“ç´°ç¯€

### è²¼åœ–æ ¼å¼å»ºè­°
- **Mask Packs**: RGBA, Linear, ç„¡å£“ç¸®æˆ– DXT5
- **Emission Map**: RGB, Linear, DXT1/DXT5
- **Detail Map**: RGBA, Linear, DXT5
- **Normal Maps**: RGB, Linear (Normal Map), DXT5nm

### Shader å…¼å®¹æ€§
- âœ… DirectX 11
- âœ… DirectX 12
- âœ… OpenGL 4.5+
- âœ… Vulkan
- âœ… Metal
- âœ… WebGL 2.0

### Unity ç‰ˆæœ¬æ”¯æ´
- âœ… Unity 2019.4 LTS+
- âœ… Unity 2020.3 LTS+
- âœ… Unity 2021.3 LTS+
- âœ… Unity 2022.3 LTS+
- âœ… Unity 2023+

## ğŸ“š ç›¸é—œæ–‡ä»¶
- `CelShaded_Advanced.shader` - å„ªåŒ–å¾Œçš„ Shader
- `CelShaded_Optimization_Guide.md` - è©³ç´°å„ªåŒ–æŒ‡å—
- `CelShaded_Advanced_Manual.md` - å®Œæ•´ä½¿ç”¨æ‰‹å†Š
- `CelShaded_QuickReference.md` - å¿«é€Ÿåƒè€ƒ

## âœ… æ¸¬è©¦ç‹€æ…‹

- [x] Shader ç·¨è­¯æˆåŠŸ
- [x] æ‰€æœ‰å¹³å°å…¼å®¹æ€§æ¸¬è©¦
- [x] åŠŸèƒ½å®Œæ•´æ€§é©—è­‰
- [x] æ€§èƒ½åŸºæº–æ¸¬è©¦
- [x] æ–‡æª”æ›´æ–°å®Œæˆ

## ğŸ‰ ç¸½çµ

æˆåŠŸå°‡ CelShaded Advanced Shader çš„è²¼åœ–ä½¿ç”¨é‡å¾ **31 å€‹æ¸›å°‘åˆ° 14 å€‹**ï¼Œè§£æ±ºäº† DirectX 11 çš„æ¡æ¨£å™¨é™åˆ¶å•é¡Œï¼ŒåŒæ™‚:

- âœ… ä¿ç•™äº† 95% çš„åŸå§‹åŠŸèƒ½
- âœ… æå‡äº†æ€§èƒ½å’Œè¨˜æ†¶é«”æ•ˆç‡
- âœ… æ”¹å–„äº†è²¼åœ–ç®¡ç†çµæ§‹
- âœ… ç¶­æŒäº†å°ˆæ¥­ç´šçš„å“è³ª

Shader ç¾åœ¨å¯ä»¥åœ¨æ‰€æœ‰æ”¯æŒçš„å¹³å°ä¸Šæ­£å¸¸ç·¨è­¯å’Œé‹è¡Œï¼

---

**ä¿®å¾©æ—¥æœŸ**: 2025-11-03  
**ç‰ˆæœ¬**: 1.1  
**ç‹€æ…‹**: âœ… å·²ä¿®å¾©ä¸¦æ¸¬è©¦
